import os
import numpy as np
import tensorflow as tf

class DataLoader:
    def __init__(self, input_dir, batch_size=32):
        self.input_dir = input_dir
        self.batch_size = batch_size

    def load_data(self):
        data = np.load(self.input_dir)
        data = data.reshape(-1, 768, 1)  # Reshape data
        dataset = tf.data.Dataset.from_tensor_slices(data)
        return dataset.shuffle(buffer_size=1024).batch(self.batch_size, drop_remainder=True).prefetch(tf.data.AUTOTUNE)
